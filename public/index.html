<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Screener - Modern UX</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="styles-card-redesign-fix.css">
    <link rel="stylesheet" href="presets.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="logo">
                <span>üìä</span>
                <span>Stock Screener</span>
            </div>
            <div class="header-actions">
                <div class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode" data-tooltip="Switch between light and dark mode"></div>
                <!-- User profile removed as requested -->
            </div>
        </header>
        
        <!-- Main Content Bento Grid -->
        <div class="bento-grid">
            <!-- Filters Panel -->
            <div class="glass-card filters-panel">
                <div class="card-header">
                    <div class="card-title">
                        <span>Filters</span>
                    </div>
                    <button class="btn btn-sm btn-outline" id="clear-all-filters" data-tooltip="Clear all active filters">Clear All</button>
                </div>
                <div class="card-content">
                    <!-- Basic Filters -->
                    <div class="filter-section basic-filters">
                        <div class="filter-section-header" id="basic-filters-header">
                            <div class="filter-section-title">
                                <span>üîç</span>
                                <span>Basic Filters</span>
                            </div>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="filter-section-content" id="basic-filters-content">
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Market Cap</span>
                                    <span class="info-icon" data-tooltip="Filter stocks by market capitalization size - the total value of all outstanding shares">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="market-cap" data-value="large" data-tooltip="Companies with market cap > $10 billion">Large Cap ($10B+)</div>
                                    <div class="filter-chip" data-filter="market-cap" data-value="mid" data-tooltip="Companies with market cap between $2-10 billion">Mid Cap ($2-10B)</div>
                                    <div class="filter-chip" data-filter="market-cap" data-value="small" data-tooltip="Companies with market cap between $300M-2B">Small Cap ($300M-2B)</div>
                                    <div class="filter-chip" data-filter="market-cap" data-value="micro" data-tooltip="Companies with market cap < $300 million">Micro Cap (<$300M)</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Volume</span>
                                    <span class="info-icon" data-tooltip="Filter stocks by average daily trading volume - the number of shares traded daily">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="volume" data-value="high" data-tooltip="Stocks with average daily volume > 1 million shares">High (>1M shares)</div>
                                    <div class="filter-chip" data-filter="volume" data-value="medium" data-tooltip="Stocks with average daily volume between 100K-1M shares">Medium (100K-1M)</div>
                                    <div class="filter-chip" data-filter="volume" data-value="low" data-tooltip="Stocks with average daily volume < 100K shares">Low (<100K shares)</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Debt</span>
                                    <span class="info-icon" data-tooltip="Filter stocks by debt level relative to company size and earnings">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="debt" data-value="low" data-tooltip="Companies with debt-to-equity ratio < 0.3">Low (D/E < 0.3)</div>
                                    <div class="filter-chip" data-filter="debt" data-value="medium" data-tooltip="Companies with debt-to-equity ratio between 0.3-0.6">Medium (D/E 0.3-0.6)</div>
                                    <div class="filter-chip" data-filter="debt" data-value="high" data-tooltip="Companies with debt-to-equity ratio > 0.6">High (D/E > 0.6)</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Valuation</span>
                                    <span class="info-icon" data-tooltip="Filter stocks by price-to-earnings (P/E) ratio - how expensive a stock is relative to its earnings">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="valuation" data-value="value" data-tooltip="Companies with P/E ratio < 15">Value (P/E < 15)</div>
                                    <div class="filter-chip" data-filter="valuation" data-value="growth" data-tooltip="Companies with P/E ratio > 25">Growth (P/E > 25)</div>
                                    <div class="filter-chip" data-filter="valuation" data-value="blend" data-tooltip="Companies with P/E ratio between 15-25">Blend (P/E 15-25)</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>ROTCE</span>
                                    <span class="info-icon" data-tooltip="Return on Tangible Common Equity - measures how efficiently a company uses its tangible assets to generate profits">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="rotce" data-value="excellent" data-tooltip="Companies with excellent ROTCE above 20%">Excellent (>20%)</div>
                                    <div class="filter-chip" data-filter="rotce" data-value="good" data-tooltip="Companies with good ROTCE between 15-20%">Good (15-20%)</div>
                                    <div class="filter-chip" data-filter="rotce" data-value="average" data-tooltip="Companies with average ROTCE between 10-15%">Average (10-15%)</div>
                                    <div class="filter-chip" data-filter="rotce" data-value="poor" data-tooltip="Companies with poor ROTCE below 10%">Poor (<10%)</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Numeric Gates -->
                    <div class="filter-section numeric-gates">
                        <div class="filter-section-header" id="numeric-gates-header">
                            <div class="filter-section-title">
                                <span>üßÆ</span>
                                <span>Numeric Gates</span>
                            </div>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="filter-section-content" id="numeric-gates-content">
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Debt/EBITDA</span>
                                    <span class="info-icon" data-tooltip="Debt to EBITDA ratio - measures a company's ability to pay off its debt using earnings before interest, taxes, depreciation, and amortization">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="debt-ebitda" data-value="1" data-tooltip="Companies with Debt/EBITDA ratio less than or equal to 1">‚â§ 1√ó</div>
                                    <div class="filter-chip" data-filter="debt-ebitda" data-value="0.5" data-tooltip="Companies with Debt/EBITDA ratio less than or equal to 0.5">‚â§ 0.5√ó</div>
                                    <div class="filter-chip" data-filter="debt-ebitda" data-value="0.25" data-tooltip="Companies with Debt/EBITDA ratio less than or equal to 0.25">‚â§ 0.25√ó</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>FCF/NI Ratio</span>
                                    <span class="info-icon" data-tooltip="Free Cash Flow to Net Income ratio - measures the quality of earnings and how well net income translates to actual cash generation">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="fcf-ni" data-value="0.8" data-tooltip="Companies with FCF/NI ratio greater than or equal to 0.8">‚â• 0.8</div>
                                    <div class="filter-chip" data-filter="fcf-ni" data-value="1.0" data-tooltip="Companies with FCF/NI ratio greater than or equal to 1.0">‚â• 1.0</div>
                                    <div class="filter-chip" data-filter="fcf-ni" data-value="1.2" data-tooltip="Companies with FCF/NI ratio greater than or equal to 1.2">‚â• 1.2</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Share Count CAGR</span>
                                    <span class="info-icon" data-tooltip="Share Count Compound Annual Growth Rate - measures the rate at which a company is diluting or reducing its outstanding shares">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="share-cagr" data-value="0" data-tooltip="Companies with stable or decreasing share count">‚â§ 0%</div>
                                    <div class="filter-chip" data-filter="share-cagr" data-value="-2" data-tooltip="Companies reducing share count by at least 2% annually">‚â§ -2%</div>
                                    <div class="filter-chip" data-filter="share-cagr" data-value="-5" data-tooltip="Companies reducing share count by at least 5% annually">‚â§ -5%</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>EV/EBIT</span>
                                    <span class="info-icon" data-tooltip="Enterprise Value to Earnings Before Interest and Taxes - a valuation metric that compares a company's total value to its operational earnings">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="ev-ebit" data-value="10" data-tooltip="Companies with EV/EBIT ratio less than or equal to 10">‚â§ 10√ó</div>
                                    <div class="filter-chip" data-filter="ev-ebit" data-value="8" data-tooltip="Companies with EV/EBIT ratio less than or equal to 8">‚â§ 8√ó</div>
                                    <div class="filter-chip" data-filter="ev-ebit" data-value="6" data-tooltip="Companies with EV/EBIT ratio less than or equal to 6">‚â§ 6√ó</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Deep Value</span>
                                    <span class="info-icon" data-tooltip="Price to Net Current Asset Value - identifies stocks trading below their liquidation value, a classic Benjamin Graham deep value metric">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="deep-value" data-value="0.66" data-tooltip="Companies trading at less than 2/3 of their net current asset value">P/NCAV ‚â§ 0.66</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Qualitative Filters -->
                    <div class="filter-section qualitative-filters">
                        <div class="filter-section-header" id="qualitative-filters-header">
                            <div class="filter-section-title">
                                <span>üî¨</span>
                                <span>Qualitative Filters</span>
                            </div>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="filter-section-content" id="qualitative-filters-content">
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Moat Keywords</span>
                                    <span class="info-icon" data-tooltip="Scans company reports for keywords indicating competitive advantages or economic moats">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="moat-keywords" data-value="3" data-tooltip="Companies with at least 3 moat-related keywords in their reports">‚â• 3 hits</div>
                                    <div class="filter-chip" data-filter="moat-keywords" data-value="5" data-tooltip="Companies with at least 5 moat-related keywords in their reports">‚â• 5 hits</div>
                                    <div class="filter-chip" data-filter="moat-keywords" data-value="10" data-tooltip="Companies with at least 10 moat-related keywords in their reports">‚â• 10 hits</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Insider Ownership</span>
                                    <span class="info-icon" data-tooltip="Percentage of shares owned by company insiders like executives and directors - indicates alignment with shareholders">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="insider-ownership" data-value="8" data-tooltip="Companies with at least 8% insider ownership">‚â• 8%</div>
                                    <div class="filter-chip" data-filter="insider-ownership" data-value="15" data-tooltip="Companies with at least 15% insider ownership">‚â• 15%</div>
                                    <div class="filter-chip" data-filter="insider-ownership" data-value="25" data-tooltip="Companies with at least 25% insider ownership">‚â• 25%</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Net Insider Buys</span>
                                    <span class="info-icon" data-tooltip="Net number of insider purchase transactions over the past 12 months - indicates insider confidence">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="insider-buys" data-value="1" data-tooltip="Companies with any net insider buying over the past 12 months">Any</div>
                                    <div class="filter-chip" data-filter="insider-buys" data-value="3" data-tooltip="Companies with at least 3 net insider buys over the past 12 months">‚â• 3</div>
                                    <div class="filter-chip" data-filter="insider-buys" data-value="5" data-tooltip="Companies with at least 5 net insider buys over the past 12 months">‚â• 5</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Gross Margin Trend</span>
                                    <span class="info-icon" data-tooltip="Direction of gross profit margin over time - indicates pricing power and competitive position">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="margin-trend" data-value="improving" data-tooltip="Companies with improving gross margins over the past 3 years">Improving</div>
                                    <div class="filter-chip" data-filter="margin-trend" data-value="stable" data-tooltip="Companies with stable gross margins over the past 3 years">Stable</div>
                                    <div class="filter-chip" data-filter="margin-trend" data-value="any" data-tooltip="Include all companies regardless of gross margin trend">Any</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Incremental ROIC</span>
                                    <span class="info-icon" data-tooltip="Return on Incremental Invested Capital - measures how efficiently a company uses new capital investments">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="inc-roic" data-value="15" data-tooltip="Companies with incremental ROIC of at least 15%">‚â• 15%</div>
                                    <div class="filter-chip" data-filter="inc-roic" data-value="20" data-tooltip="Companies with incremental ROIC of at least 20%">‚â• 20%</div>
                                    <div class="filter-chip" data-filter="inc-roic" data-value="25" data-tooltip="Companies with incremental ROIC of at least 25%">‚â• 25%</div>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <div class="filter-group-title">
                                    <span>Exclude Red Flags</span>
                                    <span class="info-icon" data-tooltip="Exclude companies with potential warning signs that may indicate problems">i</span>
                                </div>
                                <div class="filter-chips">
                                    <div class="filter-chip" data-filter="exclude-flags" data-value="audit" data-tooltip="Exclude companies that have changed auditors in the past 2 years">Audit Changes</div>
                                    <div class="filter-chip" data-filter="exclude-flags" data-value="management" data-tooltip="Exclude companies with significant executive departures in the past year">Management Exits</div>
                                    <div class="filter-chip" data-filter="exclude-flags" data-value="all" data-tooltip="Exclude companies with any red flags">All Red Flags</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ranking System -->
                    <div class="filter-section ranking-system">
                        <div class="filter-section-header" id="ranking-system-header">
                            <div class="filter-section-title">
                                <span>üèÖ</span>
                                <span>Ranking System</span>
                            </div>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="filter-section-content" id="ranking-system-content">
                            <div class="ranking-cards">
                                <div class="ranking-card" data-ranking="owner-earnings" data-tooltip="Rank stocks by Owner-Earnings Yield (adjusted cash flow relative to enterprise value)">
                                    <div class="ranking-icon">üí∞</div>
                                    <div class="ranking-title">Owner-Earnings Yield</div>
                                </div>
                                <div class="ranking-card" data-ranking="rotce" data-tooltip="Rank stocks by Return on Tangible Common Equity (profitability metric)">
                                    <div class="ranking-icon">üìà</div>
                                    <div class="ranking-title">ROTCE</div>
                                </div>
                                <div class="ranking-card" data-ranking="combined" data-tooltip="Rank stocks using a combined score of multiple metrics weighted for balanced performance">
                                    <div class="ranking-icon">‚öñÔ∏è</div>
                                    <div class="ranking-title">Combined Score</div>
                                </div>
                            </div>
                            
                            <div class="toggle-switch">
                                <div class="toggle-label">Track Rank Momentum</div>
                                <div class="toggle" id="rank-momentum-toggle" data-tooltip="Track changes in ranking position over time to identify improving stocks"></div>
                            </div>
                            
                            <div class="export-buttons">
                                <button class="export-button" id="export-csv" data-tooltip="Export filtered results to CSV format for spreadsheet analysis">
                                    <span>üìÑ</span>
                                    <span>CSV</span>
                                </button>
                                <button class="export-button" id="export-json" data-tooltip="Export filtered results to JSON format for programmatic use">
                                    <span>üìä</span>
                                    <span>JSON</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Stats Panel -->
            <div class="glass-card stats-panel">
                <div class="card-header">
                    <div class="card-title">
                        <span>Key Metrics</span>
                    </div>
                    <button class="btn btn-sm btn-outline" id="customize-metrics" data-tooltip="Customize which metrics are displayed in this panel">Customize</button>
                </div>
                <div class="card-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="total-stocks">42</div>
                            <div class="stat-label">Stocks Passing Filters</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="avg-debt-ebitda">0.38√ó</div>
                            <div class="stat-label">Avg. Debt/EBITDA</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="avg-ev-ebit">8.4√ó</div>
                            <div class="stat-label">Avg. EV/EBIT</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="avg-fcf-ni">1.06</div>
                            <div class="stat-label">Avg. FCF/NI</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="avg-rotce">35.5%</div>
                            <div class="stat-label">Avg. ROTCE</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="glass-card main-content">
                <div class="card-header">
                    <div class="card-title">
                        <span>Stocks</span>
                    </div>
                    <div class="view-controls">
                        <button class="view-button" id="card-view-button" data-tooltip="View stocks as cards with key metrics">
                            <span>üÉè</span>
                            <span>Card View</span>
                        </button>
                        <button class="view-button active" id="table-view-button" data-tooltip="View stocks as a detailed table">
                            <span>üìã</span>
                            <span>Table View</span>
                        </button>
                    </div>
                </div>
                <div class="card-content">
                    <div class="search-bar">
                        <span class="search-icon">üîç</span>
                        <input type="text" class="search-input" id="search-input" placeholder="Search by symbol, name, or sector..." data-tooltip="Enter stock symbol, company name, or sector to filter results">
                    </div>
                    
                    <!-- Applied Filters -->
                    <div class="applied-filters" id="applied-filters">
                        <!-- Applied filters will be added here dynamically -->
                    </div>
                    
                    <!-- Stock Cards View (hidden by default) -->
                    <div class="stock-cards" id="stock-cards" style="display: none;">
                        <!-- Stock cards will be added here dynamically -->
                    </div>
                    
                    <!-- Stock Table View -->
                    <div class="stock-table-container">
                        <table class="stock-table" id="stock-table">
                            <thead>
                                <tr>
                                    <th>Symbol</th>
                                    <th>Company</th>
                                    <th>Price</th>
                                    <th>Debt/EBITDA</th>
                                    <th>FCF/NI</th>
                                    <th>EV/EBIT</th>
                                    <th>ROTCE</th>
                                    <th>Score</th>
                                </tr>
                            </thead>
                            <tbody id="stock-table-body">
                                <!-- Stock rows will be added here dynamically -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="pagination" id="pagination">
                        <!-- Pagination controls will be added here dynamically -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Mobile Filter Button (visible only on mobile) -->
    <div class="filter-button" id="mobile-filter-button" data-tooltip="Open filter options">
        <span>üîç</span>
        <span>Filters (<span id="active-filter-count">0</span>)</span>
    </div>
    
    <!-- Bottom Sheet (for mobile) -->
    <div class="bottom-sheet" id="filter-bottom-sheet">
        <div class="sheet-handle"></div>
        <div class="sheet-header">
            <div class="sheet-title">Filters</div>
            <div class="sheet-close" id="close-bottom-sheet">√ó</div>
        </div>
        
        <!-- Filter Tabs -->
        <div class="filter-tabs" id="filter-tabs">
            <div class="filter-tab active" data-tab="basic" data-tooltip="Basic stock filtering options">Basic</div>
            <div class="filter-tab" data-tab="numeric" data-tooltip="Advanced numerical filtering criteria">Numeric Gates</div>
            <div class="filter-tab" data-tab="qualitative" data-tooltip="Qualitative analysis filters">Qualitative</div>
            <div class="filter-tab" data-tab="ranking" data-tooltip="Stock ranking and scoring options">Ranking</div>
        </div>
        
        <div class="sheet-content">
            <!-- Filter content will be dynamically loaded here based on selected tab -->
            <div class="filter-content active" id="mobile-basic-filters">
                <!-- Basic filters content will be cloned here -->
            </div>
            
            <div class="filter-content" id="mobile-numeric-gates">
                <!-- Numeric gates content will be cloned here -->
            </div>
            
            <div class="filter-content" id="mobile-qualitative-filters">
                <!-- Qualitative filters content will be cloned here -->
            </div>
            
            <div class="filter-content" id="mobile-ranking-system">
                <!-- Ranking system content will be cloned here -->
            </div>
        </div>
        
        <div class="sheet-footer">
            <button class="sheet-button secondary" id="reset-filters" data-tooltip="Clear all selected filters">Reset</button>
            <button class="sheet-button primary" id="apply-filters" data-tooltip="Apply selected filters to stock list">Apply Filters</button>
        </div>
    </div>
    
    <div class="overlay" id="bottom-sheet-overlay"></div>
    <div class="tooltip" id="tooltip"></div>
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles-card-redesign-fix.css">
    
    <!-- Scripts -->
    <script src="app.js"></script>
    <script src="card-view-redesign-fix.js"></script>
    <script src="presets.js"></script>
</body>
</html>
